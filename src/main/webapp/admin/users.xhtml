<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:a4j="http://richfaces.org/a4j"
        >
<ui:composition template="../template.xhtml">
    <ui:define name="content">
        <h:form id="formUser">
            <h3>Users </h3>
            <rich:extendedDataTable id="tblUser" value="#{userFacade.all}" var="user"
                                    border="1" sortMode="single"
                                    noDataLabel="No data found...">
                <rich:column width="50px">
                    <f:facet name="header">
                        <a4j:commandButton id="btAddUser"
                                           image="/resources/images/add.png"
                                           action="#{userCrudBean.startNewEntity()}"
                                           render="popupEditUser formPopupEditUser"
                                           oncomplete="#{rich:component('popupEditUser')}.show();"/>
                    </f:facet>
                    <h:panelGrid columns="2">
                        <a4j:commandButton id="btEditUser"
                                           image="/resources/images/edit.png"
                                           action="#{userCrudBean.startEditEntity(user.myClone)}"
                                           render=":popupEditUser :formPopupEditUser"
                                           oncomplete="#{rich:component(':popupEditUser')}.show();"/>
                        <a4j:commandButton id="btDeleteUser"
                                           styleClass="imageLink"
                                           image="/resources/images/delete.png"
                                           action="#{userCrudBean.startDelete(user)}"
                                           render=":popupDeleteUser :formPopupDeleteUser"
                                           oncomplete="#{rich:component('popupDeleteUser')}.show();"/>
                    </h:panelGrid>
                </rich:column>
                <rich:column sortBy="#{user.username}">
                    <f:facet name="header">
                        <h:outputLabel value="Username"/>
                    </f:facet>
                    <h:outputText value="#{user.username}"/>
                </rich:column>
                <rich:column sortBy="#{user.adminRole}">
                    <f:facet name="header">
                        <h:outputLabel value="AdminRole"/>
                    </f:facet>
                    <h:outputText value="#{user.adminRole}"/>
                </rich:column>
                <f:facet name="footer">
                    <rich:dataScroller renderIfSinglePage="false"/>
                </f:facet>

            </rich:extendedDataTable>
        </h:form>

        <rich:popupPanel id="popupEditUser" modal="true" autosized="true" resizeable="false">
            <f:facet name="header">
                <h:outputText value="Users"/>
            </f:facet>
            <h:form id="formPopupEditUser">
                <h:outputText value="Saisie de User"/>
                <br/>
                <br/>
                <h:panelGrid columns="3">
                    <h:outputLabel value="Username"/>
                    <h:inputText id="itUsername" value="#{userCrudBean.editEntity.username}" required="true" requiredMessage="Enter a username"/>
                    <rich:message for="itUsername"/>

                    <h:outputLabel value="Password"/>
                    <h:inputText id="itPassword" value="#{userCrudBean.editEntity.password}" required="true" requiredMessage="Enter a password"/>
                    <rich:message for="itPassword"/>

                    <h:outputLabel value="AdminRole"/>
                    <h:selectBooleanCheckbox id="sbcAdminRole" value="#{userCrudBean.editEntity.adminRole}"/>
                    <rich:message for="sbcAdminRole"/>
                </h:panelGrid>
                <br/>
                <br/>
                <rich:messages id="msgPopupEditUser" globalOnly="true"/>
                <a4j:commandButton value="Sauvegarder" action="#{userCrudBean.doSaveEdit()}"
                                   render="msgPopupEditUser :tblUser"
                                   oncomplete="if(#{facesContext.maximumSeverity==null}) #{rich:component(':popupEditUser')}.hide(); return false;"/>
                <a4j:commandButton value="Cancel" action="#{userCrudBean.doCancel()}" immediate="true"
                                   oncomplete="#{rich:component(':popupEditUser')}.hide(); return false;"/>
            </h:form>
        </rich:popupPanel>

        <rich:popupPanel id="popupDeleteUser" modal="true" autosized="true" resizeable="false">
            <f:facet name="header">
                <h:outputText value="Users"/>
            </f:facet>
            <h:form id="formPopupDeleteUser">
                <h:outputText value="Confirmer la suppression pour:"/>
                <br/>
                <br/>
                <h:panelGrid columns="2">
                    <h:outputLabel value="Username"/>
                    <h:outputText value="#{userCrudBean.toDeleteEntity.username}"/>
                    <h:outputLabel value="Password"/>
                    <h:outputText value="*********"/>
                    <h:outputLabel value="AdminRole"/>
                    <h:outputText value="#{userCrudBean.toDeleteEntity.adminRole}"/>
                </h:panelGrid>
                <br/>
                <a4j:commandButton value="Supprimer" action="#{userCrudBean.doDelete()}"
                                   render=":tblUser"
                                   oncomplete="#{rich:component(':popupDeleteUser')}.hide(); return false;"/>
                <a4j:commandButton value="Cancel" action="#{userCrudBean.doCancel()}"
                                   oncomplete="#{rich:component(':popupDeleteUser')}.hide(); return false;"/>
                <rich:messages/>
            </h:form>
        </rich:popupPanel>
    </ui:define>
</ui:composition>
</html>